/*! bookdrift 2015-07-12 author:Mickey */
var AddBookForm=React.createClass({displayName:"AddBookForm",submit:function(a){a.preventDefault();var b=this;$.ajax({url:"/book/add/by/"+localStorage.userId+"/",type:"POST",data:new FormData(a.target),contentType:!1,processData:!1,success:function(a){"200"==a&&($("#addBookForm input").val(""),b.props.success())}})},render:function(){return React.createElement("form",{className:"form-horizontal",onSubmit:this.submit,id:"addBookForm",encType:"multipart/form-data"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputName",className:"col-sm-2 control-label"},"书名"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputName",ref:"name",name:"name"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputAuthor",className:"col-sm-2 control-label"},"作者"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputAuthor",ref:"author",name:"author"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputPicture",className:"col-sm-2 control-label"},"封面"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"file",className:"form-control",id:"inputPicture",ref:"picture",name:"picture"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputKind",className:"col-sm-2 control-label"},"类型"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputKind",ref:"kind",name:"kind"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputDescription",className:"col-sm-2 control-label"},"简介"),React.createElement("div",{className:"col-sm-10"},React.createElement("textarea",{className:"form-control",id:"inputDescription",ref:"description",name:"description"}))),React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-10 col-sm-offset-2"},React.createElement("input",{type:"submit",className:"form-control",value:"提交"}))))}}),AddCommentForm=React.createClass({displayName:"AddCommentForm",setMark:function(a){var b=a.target.id,c=$("#"+b);c.prevAll("span").removeClass("glyphicon-star-empty"),c.nextAll("span").removeClass("glyphicon-star"),c.removeClass("glyphicon-star-empty"),c.addClass("glyphicon-star"),c.prevAll("span").addClass("glyphicon-star"),c.nextAll("span").addClass("glyphicon-star-empty")},addComment:function(){var a=$(".glyphicon-star").length,b=React.findDOMNode(this.refs.content).value,c={mark:a,content:b},d=this.props.book.pk,e=localStorage.userId,f="/book/"+d+"/comment/add/by/"+e+"/";$.post(f,c,function(a){"200"!=a?alert("添加评论失败"):($(".glyphicon").removeClass("glyphicon-star"),$("#inputComment").val(""),alert("成功添加评论"))})},render:function(){return React.createElement("div",{className:"form-horizontal",id:"addCommentForm"},React.createElement("h4",null,"添加评论："),React.createElement("div",{className:"form-group",style:{marginLeft:20}},React.createElement("label",null,"评分："),React.createElement("span",{onClick:this.setMark,className:"glyphicon glyphicon-star-empty",id:"mark1"}),React.createElement("span",{onClick:this.setMark,className:"glyphicon glyphicon-star-empty",id:"mark2"}),React.createElement("span",{onClick:this.setMark,className:"glyphicon glyphicon-star-empty",id:"mark3"}),React.createElement("span",{onClick:this.setMark,className:"glyphicon glyphicon-star-empty",id:"mark4"}),React.createElement("span",{onClick:this.setMark,className:"glyphicon glyphicon-star-empty",id:"mark5"})),React.createElement("div",{className:"form-group",style:{marginLeft:20}},React.createElement("label",{htmlFor:"inputComment"},"内容："),React.createElement("input",{type:"text",className:"form-control",id:"inputComment",ref:"content",name:"content",placeholder:"写下你的评论吧"})),React.createElement("div",{className:"form-group",style:{marginLeft:20}},React.createElement("button",{className:"btn",onClick:this.addComment},"评论")))}}),ApplyButton=React.createClass({displayName:"ApplyButton",addApply:function(){var a=localStorage.userId,b=this.props.book.pk,c="/drift/"+b+"/apply/by/"+a+"/";$.get(c,function(a){"200"==a&&alert("申请成功")})},render:function(){return React.createElement("a",{className:"btn btn-primary",role:"button",onClick:this.addApply},"想要")}}),ApplyHistory=React.createClass({displayName:"ApplyHistory",getInitialState:function(){return{users:[]}},render:function(){return React.createElement("div",null)}}),Book=React.createClass({displayName:"Book",render:function(){var a="/media/"+this.props.book.fields.picture,b="#"+this.props.book.pk;return React.createElement("div",{className:"col-sm-3 book"},React.createElement("div",{className:"thumbnail",style:{textAlign:"center",border:"none"}},React.createElement("a",{href:b},React.createElement("img",{src:a,style:{width:242,height:200}})),React.createElement("div",{className:"caption"},React.createElement("h3",null,this.props.book.fields.name),React.createElement("p",null,this.props.book.fields.author),React.createElement("p",null,this.props.book.fields.kind),React.createElement("p",null,React.createElement(ApplyButton,{book:this.props.book}),React.createElement(LikeButton,{book:this.props.book})))))}}),BookApplies=React.createClass({displayName:"BookApplies",getInitialState:function(){return{applies:[]}},componentDidMount:function(){this.loadDataFromServer()},loadDataFromServer:function(){var a=this.props.bookId,b="/drift/"+a+"/apply/get/";$.get(b,function(a){a=JSON.parse(a);var b=a.map(function(a){return{user:a.fields.user,time:a.fields.createTime}});this.setState({applies:b})}.bind(this))},render:function(){var a=this.state.applies.map(function(a){return React.createElement("span",{style:{margin:15}},React.createElement(UserAvatar,{userId:a.user}),React.createElement("br",null),React.createElement("span",null,a.time))});return React.createElement("div",{style:{display:"flex",alignItems:"center"}},React.createElement("h4",null,"申请者们："),a)}}),BookDetail=React.createClass({displayName:"BookDetail",getInitialState:function(){return{book:{pk:this.props.bookId}}},componentDidMount:function(){this.loadDataFromServer()},loadDataFromServer:function(){var a=this.props.bookId,b="/book/"+a+"/get/";$.get(b,function(a){a=JSON.parse(a);var b=a[0];this.setState({book:b})}.bind(this))},render:function(){if(!this.state.book.fields)return React.createElement("div",null);console.log(this.state.book);var a="/media/"+this.state.book.fields.picture;return React.createElement("div",{className:"container"},React.createElement("div",{className:"pull-left"},React.createElement("img",{src:a})),React.createElement("div",{className:"pull-left",style:{marginLeft:50,width:500}},React.createElement("p",null,"书名：",this.state.book.fields.name),React.createElement("p",null,"作者：",this.state.book.fields.author),React.createElement("p",null,"类型：",this.state.book.fields.kind),React.createElement("p",null,"拥有者：",React.createElement(UserAvatar,{userId:this.state.book.fields.originOwner})),React.createElement("p",null,"所在处：",React.createElement(UserAvatar,{userId:this.state.book.fields.currentOwner})),React.createElement("p",{style:{width:400}},React.createElement("h4",null,"简介："),React.createElement("span",{style:{width:400}},this.state.book.fields.description)),React.createElement("p",null,React.createElement(ApplyButton,{book:this.state.book}),React.createElement(LikeButton,{book:this.state.book}))),React.createElement("br",{style:{clear:"both"}}),React.createElement("hr",null),React.createElement(BookApplies,{bookId:this.state.book.pk}),React.createElement("hr",null),React.createElement(CommentList,{book:this.state.book}),React.createElement("hr",null),React.createElement(AddCommentForm,{book:this.state.book}))}}),BookList=React.createClass({displayName:"BookList",getInitialState:function(){return{books:[]}},componentDidMount:function(){this.loadDataFromServer()},loadDataFromServer:function(){var a=this.props.url;$.get(a,function(a){a=JSON.parse(a),this.setState({books:a})}.bind(this))},render:function(){console.log(this.state.books);for(var a=[],b=0;b<this.state.books.length;b++){var c=this.state.books[b];console.log(c),a.push(React.createElement(Book,{book:c}))}return React.createElement("div",{className:"bookList"},a)}}),BookRecord=React.createClass({displayName:"BookRecord",getInitialState:function(){return{nextApply:null,showForm:!1}},componentDidMount:function(){this.loadDataFromServer()},loadDataFromServer:function(){var a=this.props.book.pk,b="/drift/"+a+"/next/get/";$.get(b,function(a){if(a=JSON.parse(a),a.length){var b=a[0],c=this.state.showForm;this.setState({nextApply:b,showForm:c})}}.bind(this))},getRightPart:function(){var a=this.state.nextApply;if(!a)return React.createElement("span",null,"暂无申请者");var b=a.fields.user;return React.createElement("span",null,React.createElement(UserAvatar,{userId:b}),React.createElement("span",{onClick:this.addDrift},"转给他"))},addDrift:function(){var a=this.state.nextApply,b=a.fields.user,c=this.props.book.pk,d="/drift/"+c+"/to/"+b+"/";$.get(d,function(a){"200"==a&&this.unmount()}.bind(this))},unmount:function(){var a=this.getDOMNode();React.unmountComponentAtNode(a),$(a).remove()},showUpdateForm:function(){this.toggleForm(!0)},closeForm:function(){this.toggleForm(!1)},toggleForm:function(a){var b=this.state.nextApply;this.setState({nextApply:b,showForm:a})},render:function(){var a="/media/"+this.props.book.fields.picture,b=this.getRightPart();return React.createElement("div",{className:"media",style:{borderTop:"solid 1px #ddd"}},React.createElement("div",{className:"media-left"},React.createElement("img",{className:"media-object",src:a,style:{width:242,height:200}})),React.createElement("div",{className:"media-body"},React.createElement("h4",{className:"media-heading"},this.props.book.fields.name),React.createElement("p",null,this.props.book.fields.author),React.createElement("p",null,this.props.book.fields.description),React.createElement("button",{className:"btn",onClick:this.showUpdateForm},"修正"),React.createElement("span",{className:"pull-right"},b)),React.createElement(ReactBootstrap.Modal,{show:this.state.showForm,onHide:this.closeForm},React.createElement(ReactBootstrap.Modal.Header,{closeButton:!0},React.createElement(ReactBootstrap.Modal.Title,null,"修正书籍")),React.createElement(ReactBootstrap.Modal.Body,null,React.createElement(UpdateBookForm,{book:this.props.book,success:this.closeForm}))))}}),BookRecordList=React.createClass({displayName:"BookRecordList",getInitialState:function(){return{books:[],showAddForm:!1}},componentDidMount:function(){this.loadDataFromServer(),setInterval(this.loadDataFromServer,2e3)},loadDataFromServer:function(){var a=localStorage.userId,b="/book/of/"+a+"/";$.get(b,function(a){a=JSON.parse(a);var b=this.state.showAddForm;this.setState({books:a,showAddForm:b})}.bind(this)).fail(ajaxFail)},addBook:function(){var a=this.state.books;this.setState({books:a,showAddForm:!0})},closeForm:function(){var a=this.state.books;this.setState({books:a,showAddForm:!1})},render:function(){var a=this.state.books.map(function(a){return React.createElement(BookRecord,{book:a})});return console.log(a),React.createElement("div",{className:"list container"},React.createElement("h4",null,"我的漂流书",React.createElement("span",{onClick:this.addBook,className:"pull-right"},"添加")),a,React.createElement(ReactBootstrap.Modal,{show:this.state.showAddForm,onHide:this.closeForm},React.createElement(ReactBootstrap.Modal.Header,{closeButton:!0},React.createElement(ReactBootstrap.Modal.Title,null,"添加书籍")),React.createElement(ReactBootstrap.Modal.Body,null,React.createElement(AddBookForm,{success:this.closeForm}))))}}),BooksIndex=React.createClass({displayName:"BooksIndex",render:function(){return React.createElement("div",{className:"container"},React.createElement("div",{className:"well"},React.createElement("h4",null,"热门书籍"),React.createElement(BookList,{url:"/book/popular/"}),React.createElement("div",{style:{clear:"both"}})),React.createElement("div",null,React.createElement(BookList,{url:"/book/all/"})))}}),Comment=React.createClass({displayName:"Comment",componentDidMount:function(){this.loadDataFromServer()},getInitialState:function(){return{userName:""}},loadDataFromServer:function(){var a=this.props.comment.fields.user,b="/user/"+a+"/get/";$.get(b,function(a){a=JSON.parse(a),name=a.fields.name,this.setState({userName:name})}.bind(this))},render:function(){"/user/"+this.props.comment.fields.user+"/avatar/get/";return React.createElement("div",{className:"media"},React.createElement("div",{className:"media-left"},React.createElement(UserAvatar,{userId:this.props.comment.fields.user})),React.createElement("div",{className:"media-body"},React.createElement("h4",{className:"media-heading"},this.state.userName),"评分：",this.props.comment.fields.mark," ",React.createElement("br",null),"内容：",this.props.comment.fields.content))}}),CommentList=React.createClass({displayName:"CommentList",getInitialState:function(){return{comments:[]}},loadDataFromServer:function(){var a=this.props.book.pk,b="/book/"+a+"/comment/all/";$.get(b,function(a){a=JSON.parse(a),this.setState({comments:a})}.bind(this))},componentDidMount:function(){this.loadDataFromServer(),setInterval(this.loadDataFromServer,2e3)},render:function(){var a=this.state.comments.map(function(a){return React.createElement(Comment,{comment:a})});return React.createElement("div",{className:"commentList"},React.createElement("h4",null,"评论："),a)}}),DriftHistory=React.createClass({displayName:"DriftHistory",render:function(){return React.createElement("div",null)}}),LikeButton=React.createClass({displayName:"LikeButton",getInitialState:function(){return{like:0}},componentDidMount:function(){this.loadDataFromServer(),setInterval(this.loadDataFromServer,2e3)},loadDataFromServer:function(){var a="/book/"+this.props.book.pk+"/like/get/number/";$.get(a,function(a){this.setState({like:a})}.bind(this))},addLike:function(){var a=localStorage.userId,b="/book/"+this.props.book.pk+"/like/by/"+a+"/";$.get(b,function(a){200==a&&this.loadDataFromServer()}.bind(this))},render:function(){return React.createElement("a",{className:"btn btn-default",role:"button",onClick:this.addLike},React.createElement("span",{className:"glyphicon glyphicon-thumbs-up"},this.state.like))}}),LoginForm=React.createClass({displayName:"LoginForm",submit:function(a){a.preventDefault();var b=this;$.ajax({url:"/user/login/",type:"POST",data:new FormData(a.target),contentType:!1,processData:!1,success:function(a){a>0?($("#loginForm input").val(""),localStorage.userId=a,b.props.success()):alert("用户名或密码错误")}}).fail(ajaxFail)},render:function(){return React.createElement("form",{className:"form-horizontal",id:"loginrForm",onSubmit:this.submit},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputAccount",className:"col-sm-2 control-label"},"用户名"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputAccount",ref:"account",name:"account"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputPassword",className:"col-sm-2 control-label"},"密码"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"password",className:"form-control",id:"inputPassword",ref:"password",name:"password"}))),React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-10 col-sm-offset-2"},React.createElement("input",{type:"submit",className:"form-control",value:"马上登录"}))))}}),MainView=React.createClass({displayName:"MainView",getView:function(){var a=window.location.hash.substring(1);if(!a||!this.checkLogin())return React.createElement(BooksIndex,null);if(!isNaN(a)){var b=a;return React.createElement(BookDetail,{bookId:b})}return"mybooks"==a?React.createElement(BookRecordList,null):void 0},getInitialState:function(){return{showLoginForm:!1,showRegisterForm:!1,showUpdateUserForm:!1}},toggleLoginForm:function(a){var b=this.state.showRegisterForm,c=this.state.showUpdateUserForm;this.setState({showRegisterForm:b,showUpdateUserForm:c,showLoginForm:a})},openLoginForm:function(){this.toggleLoginForm(!0)},closeLoginForm:function(){this.toggleLoginForm(!1)},toggleRegisterForm:function(a){var b=this.state.showLoginForm,c=this.state.showUpdateUserForm;this.setState({showRegisterForm:a,showUpdateUserForm:c,showLoginForm:b})},openRegisterForm:function(){this.toggleRegisterForm(!0)},closeRegisterForm:function(){this.toggleRegisterForm(!1)},toggleUpdateUserForm:function(a){var b=this.state.showLoginForm,c=this.state.showRegisterForm;this.setState({showRegisterForm:c,showUpdateUserForm:a,showLoginForm:b})},openUpdateUserForm:function(){this.toggleUpdateUserForm(!0)},closeUpdateUserForm:function(){this.toggleUpdateUserForm(!1)},checkLogin:function(){return localStorage.userId?!0:(this.openLoginForm(),!1)},formSubmitSuccessHandler:function(){this.closeRegisterForm(),this.closeLoginForm(),this.closeUpdateUserForm()},getNav:function(){return React.createElement("nav",{className:"navbar navbar-default"},React.createElement("div",{className:"container"},React.createElement("div",{className:"navbar-header"},React.createElement("button",{type:"button",className:"navbar-toggle collapsed","data-toggle":"collapse","data-target":"#bs-example-navbar-collapse-1"},React.createElement("span",{className:"sr-only"},"Toggle navigation"),React.createElement("span",{className:"icon-bar"}),React.createElement("span",{className:"icon-bar"}),React.createElement("span",{className:"icon-bar"})),React.createElement("a",{className:"navbar-brand",href:"#"},"漂流书吧")),React.createElement("div",{className:"collapse navbar-collapse",id:"bs-example-navbar-collapse-1"},React.createElement("div",{className:"navbar-form navbar-left",role:"search"},React.createElement("div",{className:"form-group"},React.createElement("input",{type:"text",className:"form-control",placeholder:"搜索",id:"searchInputBox",onChange:this.search}))),React.createElement("ul",{className:"nav navbar-nav navbar-right"},React.createElement("li",{className:"dropdown"},React.createElement("a",{href:"#",className:"dropdown-toggle","data-toggle":"dropdown",role:"button","aria-expanded":"false"},"我",React.createElement("span",{className:"caret"})),React.createElement("ul",{className:"dropdown-menu"},React.createElement("li",{onClick:this.openLoginForm},React.createElement("a",null,"登录/切换用户")),React.createElement("li",{onClick:this.openRegisterForm},React.createElement("a",null,"注册")),React.createElement("li",{onClick:this.openUpdateUserForm},React.createElement("a",null,"更新用户信息")),React.createElement("li",null,React.createElement("a",{href:"#mybooks"},"我的漂流书")),React.createElement("li",{role:"separator",className:"divider"}),React.createElement("li",{onClick:this.closeWindow},React.createElement("a",null,"退出"))))))))},search:function(a){console.log("search");var b=a.target.value.trim();$(".book").hide(),$('.book:contains("'+b+'")').show()},closeWindow:function(){window.close()},render:function(){var a=this.getView(),b=this.getNav();return React.createElement("div",null,b,a,React.createElement(ReactBootstrap.Modal,{show:this.state.showLoginForm,onHide:this.closeLoginForm},React.createElement(ReactBootstrap.Modal.Header,{closeButton:!0},React.createElement(ReactBootstrap.Modal.Title,null,"登录")),React.createElement(ReactBootstrap.Modal.Body,null,React.createElement(LoginForm,{success:this.formSubmitSuccessHandler}))),React.createElement(ReactBootstrap.Modal,{show:this.state.showRegisterForm,onHide:this.closeRegisterForm},React.createElement(ReactBootstrap.Modal.Header,{closeButton:!0},React.createElement(ReactBootstrap.Modal.Title,null,"注册")),React.createElement(ReactBootstrap.Modal.Body,null,React.createElement(RegisterForm,{success:this.formSubmitSuccessHandler}))),React.createElement(ReactBootstrap.Modal,{show:this.state.showUpdateUserForm,onHide:this.closeUpdateUserForm},React.createElement(ReactBootstrap.Modal.Header,{closeButton:!0},React.createElement(ReactBootstrap.Modal.Title,null,"用户信息")),React.createElement(ReactBootstrap.Modal.Body,null,React.createElement(UpdateUserForm,{success:this.formSubmitSuccessHandler}))))}}),RegisterForm=React.createClass({displayName:"RegisterForm",submit:function(a){a.preventDefault();var b=this;$.ajax({url:"/user/register/",type:"POST",data:new FormData(a.target),contentType:!1,processData:!1,success:function(a){"200"==a&&($("#registerForm input").val(""),b.props.success())}}).fail(ajaxFail)},render:function(){return React.createElement("form",{className:"form-horizontal",id:"registerForm",onSubmit:this.submit,enctype:"multipart/form-data"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputAccount",className:"col-sm-2 control-label"},"用户名"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputAccount",ref:"account",name:"account"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputPassword",className:"col-sm-2 control-label"},"密码"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"password",className:"form-control",id:"inputPassword",ref:"password",name:"password"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputAvatar",className:"col-sm-2 control-label"},"头像"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"file",className:"form-control",id:"inputAvatar",ref:"avatar",name:"avatar"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputName",className:"col-sm-2 control-label"},"昵称"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputName",ref:"name",name:"name"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputPhone",className:"col-sm-2 control-label"},"电话"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputPhone",ref:"phone",name:"phone"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputAddress",className:"col-sm-2 control-label"},"地址"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputAddress",ref:"address",name:"address"}))),React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-10 col-sm-offset-2"},React.createElement("input",{type:"submit",className:"form-control",value:"马上注册"}))))}}),UpdateBookForm=React.createClass({displayName:"UpdateBookForm",submit:function(a){a.preventDefault();var b=this.props.book.pk,c=this;$.ajax({url:"/book/"+b+"/update/",type:"POST",data:new FormData(a.target),contentType:!1,processData:!1,success:function(a){"200"==a&&($("#updateBookForm input").val(""),c.props.success())}})},render:function(){return React.createElement("form",{className:"form-horizontal",onSubmit:this.submit,id:"updateBookForm",encType:"multipart/form-data"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputName",className:"col-sm-2 control-label"},"书名"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputName",ref:"name",name:"name",defaultValue:this.props.book.fields.name,onChange:null}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputAuthor",className:"col-sm-2 control-label"},"作者"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputAuthor",ref:"author",name:"author",defaultValue:this.props.book.fields.author,onChange:null}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputPicture",className:"col-sm-2 control-label"},"封面"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"file",className:"form-control",id:"inputPicture",ref:"picture",name:"picture"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputKind",className:"col-sm-2 control-label"},"类型"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputKind",ref:"kind",name:"kind",defaultValue:this.props.book.fields.kind,onChange:null}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputDescription",className:"col-sm-2 control-label"},"简介"),React.createElement("div",{className:"col-sm-10"},React.createElement("textarea",{className:"form-control",id:"inputDescription",ref:"description",name:"description",defaultValue:this.props.book.fields.description,onChange:null}))),React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-10 col-sm-offset-2"},React.createElement("input",{type:"submit",className:"form-control",defaultValue:"提交"}))))}}),UpdateUserForm=React.createClass({displayName:"UpdateUserForm",getInitialState:function(){return{user:null}},componentDidMount:function(){this.loadDataFromServer()},loadDataFromServer:function(){var a=localStorage.userId,b="/user/"+a+"/get/";$.get(b,function(a){a=JSON.parse(a),user=a[0],this.setState({user:user})}.bind(this))},submit:function(a){a.preventDefault();var b=localStorage.userId,c=this;$.ajax({url:"/user/"+b+"/update/",type:"POST",data:new FormData(a.target),contentType:!1,processData:!1,success:function(a){"200"==a?($("#updateUserForm input").val(""),c.props.success()):ajaxFail()}}).fail(ajaxFail)},render:function(){return this.state.user?React.createElement("form",{className:"form-horizontal",id:"updateUserForm",onSubmit:this.submit,encType:"multipart/form-data"},React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputAccount",className:"col-sm-2 control-label"},"用户名"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputAccount",ref:"account",name:"account",value:this.state.user.fields.account}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputPassword",className:"col-sm-2 control-label"},"密码"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"password",className:"form-control",id:"inputPassword",ref:"password",name:"password"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputAvatar",className:"col-sm-2 control-label"},"头像"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"file",className:"form-control",id:"inputAvatar",ref:"avatar",name:"avatar"}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputName",className:"col-sm-2 control-label"},"昵称"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputName",ref:"name",name:"name",defaultValue:this.state.user.fields.name}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputPhone",className:"col-sm-2 control-label"},"电话"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputPhone",ref:"phone",name:"phone",defaultValue:this.state.user.fields.phone}))),React.createElement("div",{className:"form-group"},React.createElement("label",{htmlFor:"inputAddress",className:"col-sm-2 control-label"},"地址"),React.createElement("div",{className:"col-sm-10"},React.createElement("input",{type:"text",className:"form-control",id:"inputAddress",ref:"address",name:"address",defaultValue:this.state.user.fields.address}))),React.createElement("div",{className:"form-group"},React.createElement("div",{className:"col-sm-10 col-sm-offset-2"},React.createElement("input",{type:"submit",className:"form-control",value:"提交"})))):React.createElement("div",null)}}),UserAvatar=React.createClass({displayName:"UserAvatar",getInitialState:function(){return{user:null}},componentDidMount:function(){this.loadDataFromServer()},loadDataFromServer:function(){$.get("/user/"+this.props.userId+"/get/",function(a){a=JSON.parse(a),user=a[0],this.setState({user:user})}.bind(this))},render:function(){var a="/user/"+this.props.userId+"/avatar/get/",b=React.createElement("img",{style:{borderRadius:"50%",width:50,height:50,display:"inline-block"},src:a});if(!this.state.user)return b;var c=this.state.user.fields.name,d=this.state.user.fields.phone,e=this.state.user.fields.address,f=this.props.userId,g="userId_"+f;return React.createElement(ReactBootstrap.OverlayTrigger,{trigger:"hover",placement:"bottom",id:g,overlay:React.createElement(ReactBootstrap.Popover,{title:c},React.createElement("strong",null,"电话："),d,React.createElement("br",null),React.createElement("strong",null,"地址："),e)},b)}});